<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.andy.shop.mapping.cart.ProdMapper">
 
  <resultMap id="BaseResultMap" type="org.andy.shop.model.cart.vo.ProdVo">

	  <id column="id" property="id" jdbcType="BIGINT"/>
	  <result column="product_code" property="productCode"  jdbcType="VARCHAR"/>
	  <result column="product_name" property="productName"  jdbcType="VARCHAR"/>
	  <result column="quality_period" property="qualityPeriod"  jdbcType="INTEGER"/>
	  <result column="is_deleted" property="isDeleted"  jdbcType="INTEGER"/>
	  <result column="create_time" property="createTime"  jdbcType="TIMESTAMP"/>
	  <result column="update_time" property="updateTime"  jdbcType="TIMESTAMP"/>

  </resultMap>
 
  <sql id="Base_Column_List">
    id, product_code, product_name, quality_period, is_deleted, create_time, update_time
  </sql>
  
  <!-- 分页查询，商品列表 -->
  <select id="getProdByDto" resultMap="BaseResultMap"
		parameterType="org.andy.shop.model.cart.dto.ProdDto">
		SELECT
		<include refid="Base_Column_List" />
		from prod_info
		<where>
			<include refid="queryProdInfoDTO" />
		</where>
		ORDER BY
		create_time DESC
		LIMIT
		#{start}, #{rows}
	</select>
	<!-- 分页查询，商品总数 -->
  	<select id="countProdByDto" resultType="java.lang.Integer"
		parameterType="org.andy.shop.model.cart.dto.ProdDto">
		SELECT
		count(*)
		from prod_info
		<where>
			<include refid="queryProdInfoDTO" />
		</where>
	</select>
	<!-- 分页查询条件参数 -->
	<sql id="queryProdInfoDTO">
		<if test="productCode != null and productCode !=''">
			and product_code LIKE CONCAT(CONCAT('%', #{productCode}), '%')
		</if>
	</sql>
	
</mapper>